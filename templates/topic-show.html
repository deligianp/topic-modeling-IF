<!DOCTYPE html>
<html lang="en">
{% load static %}

<head>
    <title>Show model topics</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">
    <link rel="stylesheet" href='{% static "thesis_ui/css/styles.css" %}'>
    <script type="text/javascript" src='{% static "thesis_ui/scripts/jquery-3.4.1.js" %}'></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.3/Chart.min.js"></script>
</head>

<body>
{% include 'navbar.html' %}

<div class="container">
    <div class="my-sm-4">
        {% if ws_required %}
        <form method="get">
            <div class="form-group">
                <label for="model-select">Model</label>
                <div class="row mb-1">
                    <select name="selected_model" class="custom-select" id="model-select">
                        {% for model in ws_required.lda_models %}
                        <option value="{{ model.name }}" title="{{ model.training_context }}">{{ model.description }}
                        </option>
                        {% endfor %}
                    </select>
                </div>
            </div>
            <div class="form-group">
                <label for="topic-id-field">Topic index <span id="topic-id-range"></span></label>
                <div class="row">
                    <div class="input-group">
                        <input name="topic_id" type="text" id="topic-id-field" class="form-control"
                               placeholder="Topic index">
                        <div class="input-group-append">
                            <button name="submit" value="submit" class="btn">Show topic</button>
                        </div>
                    </div>
                </div>
            </div>
        </form>
        {% else %}
        <div class="alert alert-danger fade show" role="alert">
            <p>No models available</p>
        </div>
        {% endif %}
    </div>

    {% if server_error %}
    {% include "error_alert.html" %}
    {% else %}
    {% if data %}

    {% if data.top_n_terms %}
    <h3>Top {{ data.n_terms_0 }} terms for topic {{ data.topic_index }} of model "{{ data.model_description }}"</h3>
    <table class="table table-striped my-5">
        <thead>
        <tr>
            <th scope="col">Rank</th>
            <th scope="col">Term/terms</th>
            <th scope="col">Topic-term distribution</th>
        </tr>
        </thead>
        <tbody>
        {% for term in data.top_n_terms %}
        <tr>
            <td>1</td>
            <td>{{ term.label }}</td>
            <td>{{ term.value }}%</td>
        </tr>
        {% endfor %}
        </tbody>
    </table>
    {% endif %}
    {% endif %}
    {% endif %}
</div>
</body>
<script>
    topic_max_indexes={}
    {% for model in ws_required.lda_models %}
    topic_max_indexes["{{ model.name }}"]={{ model.max_topic_index }}
    {% endfor %}

    function update_chosen_model_max_topic_index() {
        chosen_model_name=$("#model-select").val()
        $("#topic-id-range").html("(0-"+topic_max_indexes[chosen_model_name]+")");
        $("#topic-id-field").attr("placeholder","For topic index, type a number between 0 and "+topic_max_indexes[chosen_model_name]);
    }

    $(document).ready(function(){
        update_chosen_model_max_topic_index();
        $("#model-select").change(update_chosen_model_max_topic_index);
    });




</script>

</html>
